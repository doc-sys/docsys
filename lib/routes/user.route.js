"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

var _interopRequireWildcard = require("@babel/runtime/helpers/interopRequireWildcard");

var _expressValidator = require("express-validator");

var _authenticate = _interopRequireWildcard(require("../lib/helpers/authenticate"));

var _user = require("../controller/user.controller");

var _userCreateNew = _interopRequireDefault(require("../lib/requestSchemas/user.createNew.json"));

var _userLogin = _interopRequireDefault(require("../lib/requestSchemas/user.login.json"));

var _userUsername = _interopRequireDefault(require("../lib/requestSchemas/user.username.json"));

var express = require('express');

var router = express.Router();
router.route('/')
/**
 * @api {get} /user/ Get All Users
 * @apiName UserNameAutoComplete
 * @apiGroup User
 * @apiDescription Gives back the full user list
 * @apiSuccess {Array} user List of user profiles
 * @apiError (500) {String} InternalError Something went wrong.
 */
.get([_user.getAllUser], function (req, res) {
  res.status(200).json({
    user: res.locals.user
  });
});
router.route('/login')
/**
 * @api {post} /user/login User login
 * @apiName userLogin
 * @apiGroup User
 * @apiDescription Logs user in and returns the user and API token
 * @apiParam {String} username
 * @apiParam {String} password
 * @apiSuccess {Object} user User profile
 * @apiSuccess {String} token API token
 * @apiError (401) {String} LoginFailed
 */
.post([function (req, res, next) {
  console.log(req.body, req.query);
  next();
}, (0, _expressValidator.checkSchema)(_userLogin["default"]), _user.authenticateUser], function (req, res) {
  res.status(200).json({
    user: res.locals.user,
    token: res.locals.token
  });
});
router.route('/signup')
/**
 * @api {post} /user/signup User signup
 * @apiName userSignup
 * @apiGroup User
 * @apiDescription Signs user up and logs in automatically
 * @apiParam {String} username Username
 * @apiParam {String} password Password according to policy
 * @apiParam {String} mail Valid email
 * @apiParam {String} displayName Full name
 * @apiSuccess {Object} user User profile
 * @apiSuccess {String} token API token
 * @apiError (500) {String} InternalError Something went wrong during signup. Most likely to be during validation.
 * @apiDeprecated Users should not be allowed to sign up by themselfes but rather be invited to use docSys
 */
.post([(0, _expressValidator.checkSchema)(_userCreateNew["default"]), _user.addUser, _user.authenticateUser], function (req, res) {
  res.status(200).json({
    user: res.locals.user,
    token: res.locals.token
  });
});
router.route('/unlock/:username')
/**
     * @api {post} /user/unlock/:username Unlock locked user
     * @apiName userUnlock
     * @apiGroup User
     * @apiDescription Unlocks user and sets login attempts to 0
     * @apiParam {String} username Username
     * @apiSuccess {Object} user User profile
     * @apiError (401) {String} AuthentificationError Not allowed to access ressource
     */
.post([_authenticate["default"], _authenticate.requireAdmin, (0, _expressValidator.checkSchema)(_userUsername["default"]), _user.unlockUser], function (req, res) {
  res.status(200).json({
    user: res.locals.user
  });
});
router.route('/:username')
/**
 * @api {get} /user/:username Get single user
 * @apiName userGetSingle
 * @apiGroup User
 * @apiDescription Returns a single user object without password
 * @apiParam {String} username
 * @apiSuccess {Object} user User profile
 * @apiError (401) {String} AuthentificationError Not allowed to access ressource
 */
.get([_authenticate["default"], (0, _expressValidator.checkSchema)(_userUsername["default"]), _user.findUser], function (req, res) {
  res.status(200).json({
    user: res.locals.user
  });
})
/**
 * @api {delete} /user/:username Delete user
 * @apiName userDeleteSingle
 * @apiGroup User
 * @apiDescription Deletes a single user
 * @apiParam {String} username
 * @apiSuccess {Object} user Username
 * @apiError (401) {String} AuthentificationError Not allowed to access ressource
 */
["delete"]([_authenticate["default"], _authenticate.requireAdmin, (0, _expressValidator.checkSchema)(_userUsername["default"]), _user.deleteUser], function (req, res) {
  res.status(200).json({
    user: res.locals.user
  });
})
/**
 * @api {post} /user/:username Update user
 * @apiName userUpdateSingle
 * @apiGroup User
 * @apiDescription Updates a single user. Changes every property that is set in the request body.
 * @apiParam {String} username
 * @apiSuccess {Object} user Updated user object
 * @apiError (401) {String} AuthentificationError Not allowed to access ressource
 */
.post([_authenticate["default"], (0, _expressValidator.checkSchema)(_userUsername["default"]), _user.updateUser], function (req, res) {
  res.status(200).json({
    user: res.locals.user
  });
});
module.exports = router;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9yb3V0ZXMvdXNlci5yb3V0ZS50cyJdLCJuYW1lcyI6WyJleHByZXNzIiwicmVxdWlyZSIsInJvdXRlciIsIlJvdXRlciIsInJvdXRlIiwiZ2V0IiwiZ2V0QWxsVXNlciIsInJlcSIsInJlcyIsInN0YXR1cyIsImpzb24iLCJ1c2VyIiwibG9jYWxzIiwicG9zdCIsIm5leHQiLCJjb25zb2xlIiwibG9nIiwiYm9keSIsInF1ZXJ5IiwibG9naW4iLCJhdXRoZW50aWNhdGVVc2VyIiwidG9rZW4iLCJzaWdudXAiLCJhZGRVc2VyIiwiYXV0aGVudGljYXRlIiwicmVxdWlyZUFkbWluIiwidXNlcm5hbWUiLCJ1bmxvY2tVc2VyIiwiZmluZFVzZXIiLCJkZWxldGVVc2VyIiwidXBkYXRlVXNlciIsIm1vZHVsZSIsImV4cG9ydHMiXSwibWFwcGluZ3MiOiI7Ozs7OztBQUNBOztBQUVBOztBQUNBOztBQUVBOztBQUNBOztBQUNBOztBQVJBLElBQUlBLE9BQU8sR0FBR0MsT0FBTyxDQUFDLFNBQUQsQ0FBckI7O0FBVUEsSUFBSUMsTUFBTSxHQUFHRixPQUFPLENBQUNHLE1BQVIsRUFBYjtBQUVBRCxNQUFNLENBQUNFLEtBQVAsQ0FBYSxHQUFiO0FBQ0k7Ozs7Ozs7O0FBREosQ0FTS0MsR0FUTCxDQVNTLENBQUNDLGdCQUFELENBVFQsRUFTdUIsVUFBQ0MsR0FBRCxFQUFNQyxHQUFOLEVBQWM7QUFDN0JBLEVBQUFBLEdBQUcsQ0FBQ0MsTUFBSixDQUFXLEdBQVgsRUFBZ0JDLElBQWhCLENBQXFCO0FBQUVDLElBQUFBLElBQUksRUFBRUgsR0FBRyxDQUFDSSxNQUFKLENBQVdEO0FBQW5CLEdBQXJCO0FBQ0gsQ0FYTDtBQWFBVCxNQUFNLENBQUNFLEtBQVAsQ0FBYSxRQUFiO0FBQ0k7Ozs7Ozs7Ozs7O0FBREosQ0FZS1MsSUFaTCxDQVlVLENBQUMsVUFBQ04sR0FBRCxFQUFNQyxHQUFOLEVBQVdNLElBQVgsRUFBb0I7QUFBRUMsRUFBQUEsT0FBTyxDQUFD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c291cmNlc0NvbnRlbnQiOlsibGV0IGV4cHJlc3MgPSByZXF1aXJlKCdleHByZXNzJylcclxuaW1wb3J0IHsgY2hlY2tTY2hlbWEgfSBmcm9tICdleHByZXNzLXZhbGlkYXRvcidcclxuXHJcbmltcG9ydCBhdXRoZW50aWNhdGUsIHsgcmVxdWlyZUFkbWluIH0gZnJvbSAnLi4vbGliL2hlbHBlcnMvYXV0aGVudGljYXRlJ1xyXG5pbXBvcnQgeyBhdXRoZW50aWNhdGVVc2VyLCBhZGRVc2VyLCBmaW5kVXNlciwgZ2V0QWxsVXNlciwgZGVsZXRlVXNlciwgdW5sb2NrVXNlciwgdXBkYXRlVXNlciB9IGZyb20gJy4uL2NvbnRyb2xsZXIvdXNlci5jb250cm9sbGVyJztcclxuXHJcbmltcG9ydCBzaWdudXAgZnJvbSAnLi4vbGliL3JlcXVlc3RTY2hlbWFzL3VzZXIuY3JlYXRlTmV3Lmpzb24nXHJcbmltcG9ydCBsb2dpbiBmcm9tICcuLi9saWIvcmVxdWVzdFNjaGVtYXMvdXNlci5sb2dpbi5qc29uJ1xyXG5pbXBvcnQgdXNlcm5hbWUgZnJvbSAnLi4vbGliL3JlcXVlc3RTY2hlbWFzL3VzZXIudXNlcm5hbWUuanNvbidcclxuXHJcbmxldCByb3V0ZXIgPSBleHByZXNzLlJvdXRlcigpXHJcblxyXG5yb3V0ZXIucm91dGUoJy8nKVxyXG4gICAgLyoqXHJcbiAgICAgKiBAYXBpIHtnZXR9IC91c2VyLyBHZXQgQWxsIFVzZXJzXHJcbiAgICAgKiBAYXBpTmFtZSBVc2VyTmFtZUF1dG9Db21wbGV0ZVxyXG4gICAgICogQGFwaUdyb3VwIFVzZXJcclxuICAgICAqIEBhcGlEZXNjcmlwdGlvbiBHaXZlcyBiYWNrIHRoZSBmdWxsIHVzZXIgbGlzdFxyXG4gICAgICogQGFwaVN1Y2Nlc3Mge0FycmF5fSB1c2VyIExpc3Qgb2YgdXNlciBwcm9maWxlc1xyXG4gICAgICogQGFwaUVycm9yICg1MDApIHtTdHJpbmd9IEludGVybmFsRXJyb3IgU29tZXRoaW5nIHdlbnQgd3JvbmcuXHJcbiAgICAgKi9cclxuICAgIC5nZXQoW2dldEFsbFVzZXJdLCAocmVxLCByZXMpID0+IHtcclxuICAgICAgICByZXMuc3RhdHVzKDIwMCkuanNvbih7IHVzZXI6IHJlcy5sb2NhbHMudXNlciB9KVxyXG4gICAgfSlcclxuXHJcbnJvdXRlci5yb3V0ZSgnL2xvZ2luJylcclxuICAgIC8qKlxyXG4gICAgICogQGFwaSB7cG9zdH0gL3VzZXIvbG9naW4gVXNlciBsb2dpblxyXG4gICAgICogQGFwaU5hbWUgdXNlckxvZ2luXHJcbiAgICAgKiBAYXBpR3JvdXAgVXNlclxyXG4gICAgICogQGFwaURlc2NyaXB0aW9uIExvZ3MgdXNlciBpbiBhbmQgcmV0dXJucyB0aGUgdXNlciBhbmQgQVBJIHRva2VuXHJcbiAgICAgKiBAYXBpUGFyYW0ge1N0cmluZ30gdXNlcm5hbWVcclxuICAgICAqIEBhcGlQYXJhbSB7U3RyaW5nfSBwYXNzd29yZFxyXG4gICAgICogQGFwaVN1Y2Nlc3Mge09iamVjdH0gdXNlciBVc2VyIHByb2ZpbGVcclxuICAgICAqIEBhcGlTdWNjZXNzIHtTdHJpbmd9IHRva2VuIEFQSSB0b2tlblxyXG4gICAgICogQGFwaUVycm9yICg0MDEpIHtTdHJpbmd9IExvZ2luRmFpbGVkXHJcbiAgICAgKi9cclxuICAgIC5wb3N0KFsocmVxLCByZXMsIG5leHQpID0+IHsgY29uc29sZS5sb2cocmVxLmJvZHksIHJlcS5xdWVyeSk7IG5leHQoKSB9LCBjaGVja1NjaGVtYShsb2dpbiksIGF1dGhlbnRpY2F0ZVVzZXJdLCAocmVxLCByZXMpID0+IHtcclxuICAgICAgICByZXMuc3RhdHVzKDIwMCkuanNvbih7IHVzZXI6IHJlcy5sb2NhbHMudXNlciwgdG9rZW46IHJlcy5sb2NhbHMudG9rZW4gfSlcclxuICAgIH0pXHJcblxyXG5yb3V0ZXIucm91dGUoJy9zaWdudXAnKVxyXG4gICAgLyoqXHJcbiAgICAgKiBAYXBpIHtwb3N0fSAvdXNlci9zaWdudXAgVXNlciBzaWdudXBcclxuICAgICAqIEBhcGlOYW1lIHVzZXJTaWdudXBcclxuICAgICAqIEBhcGlHcm91cCBVc2VyXHJcbiAgICAgKiBAYXBpRGVzY3JpcHRpb24gU2lnbnMgdXNlciB1cCBhbmQgbG9ncyBpbiBhdXRvbWF0aWNhbGx5XHJcbiAgICAgKiBAYXBpUGFyYW0ge1N0cmluZ30gdXNlcm5hbWUgVXNlcm5hbWVcclxuICAgICAqIEBhcGlQYXJhbSB7U3RyaW5nfSBwYXNzd29yZCBQYXNzd29yZCBhY2NvcmRpbmcgdG8gcG9saWN5XHJcbiAgICAgKiBAYXBpUGFyYW0ge1N0cmluZ30gbWFpbCBWYWxpZCBlbWFpbFxyXG4gICAgICogQGFwaVBhcmFtIHtTdHJpbmd9IGRpc3BsYXlOYW1lIEZ1bGwgbmFtZVxyXG4gICAgICogQGFwaVN1Y2Nlc3Mge09iamVjdH0gdXNlciBVc2VyIHByb2ZpbGVcclxuICAgICAqIEBhcGlTdWNjZXNzIHtTdHJpbmd9IHRva2VuIEFQSSB0b2tlblxyXG4gICAgICogQGFwaUVycm9yICg1MDApIHtTdHJpbmd9IEludGVybmFsRXJyb3IgU29tZXRoaW5nIHdlbnQgd3JvbmcgZHVyaW5nIHNpZ251cC4gTW9zdCBsaWtlbHkgdG8gYmUgZHVyaW5nIHZhbGlkYXRpb24uXHJcbiAgICAgKiBAYXBpRGVwcmVjYXRlZCBVc2VycyBzaG91bGQgbm90IGJlIGFsbG93ZWQgdG8gc2lnbiB1cCBieSB0aGVtc2VsZmVzIGJ1dCByYXRoZXIgYmUgaW52aXRlZCB0byB1c2UgZG9jU3lzXHJcbiAgICAgKi9cclxuICAgIC5wb3N0KFtjaGVja1NjaGVtYShzaWdudXAgYXMgYW55KSwgYWRkVXNlciwgYXV0aGVudGljYXRlVXNlcl0sIChyZXEsIHJlcykgPT4ge1xyXG4gICAgICAgIHJlcy5zdGF0dXMoMjAwKS5qc29uKHsgdXNlcjogcmVzLmxvY2Fscy51c2VyLCB0b2tlbjogcmVzLmxvY2Fscy50b2tlbiB9KVxyXG4gICAgfSlcclxuXHJcbnJvdXRlci5yb3V0ZSgnL3VubG9jay86dXNlcm5hbWUnKVxyXG4gICAgLyoqXHJcbiAgICAgICAgICogQGFwaSB7cG9zdH0gL3VzZXIvdW5sb2NrLzp1c2VybmFtZSBVbmxvY2sgbG9ja2VkIHVzZXJcclxuICAgICAgICAgKiBAYXBpTmFtZSB1c2VyVW5sb2NrXHJcbiAgICAgICAgICogQGFwaUdyb3VwIFVzZXJcclxuICAgICAgICAgKiBAYXBpRGVzY3JpcHRpb24gVW5sb2NrcyB1c2VyIGFuZCBzZXRzIGxvZ2luIGF0dGVtcHRzIHRvIDBcclxuICAgICAgICAgKiBAYXBpUGFyYW0ge1N0cmluZ30gdXNlcm5hbWUgVXNlcm5hbWVcclxuICAgICAgICAgKiBAYXBpU3VjY2VzcyB7T2JqZWN0fSB1c2VyIFVzZXIgcHJvZmlsZVxyXG4gICAgICAgICAqIEBhcGlFcnJvciAoNDAxKSB7U3RyaW5nfSBBdXRoZW50aWZpY2F0aW9uRXJyb3IgTm90IGFsbG93ZWQgdG8gYWNjZXNzIHJlc3NvdXJjZVxyXG4gICAgICAgICAqL1xyXG4gICAgLnBvc3QoW2F1dGhlbnRpY2F0ZSwgcmVxdWlyZUFkbWluLCBjaGVja1NjaGVtYSh1c2VybmFtZSBhcyBhbnkpLCB1bmxvY2tVc2VyXSwgKHJlcSwgcmVzKSA9PiB7XHJcbiAgICAgICAgcmVzLnN0YXR1cygyMDApLmpzb24oeyB1c2VyOiByZXMubG9jYWxzLnVzZXIgfSlcclxuICAgIH0pXHJcblxyXG5cclxucm91dGVyLnJvdXRlKCcvOnVzZXJuYW1lJylcclxuICAgIC8qKlxyXG4gICAgICogQGFwaSB7Z2V0fSAvdXNlci86dXNlcm5hbWUgR2V0IHNpbmdsZSB1c2VyXHJcbiAgICAgKiBAYXBpTmFtZSB1c2VyR2V0U2luZ2xlXHJcbiAgICAgKiBAYXBpR3JvdXAgVXNlclxyXG4gICAgICogQGFwaURlc2NyaXB0aW9uIFJldHVybnMgYSBzaW5nbGUgdXNlciBvYmplY3Qgd2l0aG91dCBwYXNzd29yZFxyXG4gICAgICogQGFwaVBhcmFtIHtTdHJpbmd9IHVzZXJuYW1lXHJcbiAgICAgKiBAYXBpU3VjY2VzcyB7T2JqZWN0fSB1c2VyIFVzZXIgcHJvZmlsZVxyXG4gICAgICogQGFwaUVycm9yICg0MDEpIHtTdHJpbmd9IEF1dGhlbnRpZmljYXRpb25FcnJvciBOb3QgYWxsb3dlZCB0byBhY2Nlc3MgcmVzc291cmNlXHJcbiAgICAgKi9cclxuICAgIC5nZXQoW2F1dGhlbnRpY2F0ZSwgY2hlY2tTY2hlbWEodXNlcm5hbWUgYXMgYW55KSwgZmluZFVzZXJdLCAocmVxLCByZXMpID0+IHtcclxuICAgICAgICByZXMuc3RhdHVzKDIwMCkuanNvbih7IHVzZXI6IHJlcy5sb2NhbHMudXNlciB9KVxyXG4gICAgfSlcclxuICAgIC8qKlxyXG4gICAgICogQGFwaSB7ZGVsZXRlfSAvdXNlci86dXNlcm5hbWUgRGVsZXRlIHVzZXJcclxuICAgICAqIEBhcGlOYW1lIHVzZXJEZWxldGVTaW5nbGVcclxuICAgICAqIEBhcGlHcm91cCBVc2VyXHJcbiAgICAgKiBAYXBpRGVzY3JpcHRpb24gRGVsZXRlcyBhIHNpbmdsZSB1c2VyXHJcbiAgICAgKiBAYXBpUGFyYW0ge1N0cmluZ30gdXNlcm5hbWVcclxuICAgICAqIEBhcGlTdWNjZXNzIHtPYmplY3R9IHVzZXIgVXNlcm5hbWVcclxuICAgICAqIEBhcGlFcnJvciAoNDAxKSB7U3RyaW5nfSBBdXRoZW50aWZpY2F0aW9uRXJyb3IgTm90IGFsbG93ZWQgdG8gYWNjZXNzIHJlc3NvdXJjZVxyXG4gICAgICovXHJcbiAgICAuZGVsZXRlKFthdXRoZW50aWNhdGUsIHJlcXVpcmVBZG1pbiwgY2hlY2tTY2hlbWEodXNlcm5hbWUgYXMgYW55KSwgZGVsZXRlVXNlcl0sIChyZXEsIHJlcykgPT4ge1xyXG4gICAgICAgIHJlcy5zdGF0dXMoMjAwKS5qc29uKHsgdXNlcjogcmVzLmxvY2Fscy51c2VyIH0pXHJcbiAgICB9KVxyXG4gICAgLyoqXHJcbiAgICAgKiBAYXBpIHtwb3N0fSAvdXNlci86dXNlcm5hbWUgVXBkYXRlIHVzZXJcclxuICAgICAqIEBhcGlOYW1lIHVzZXJVcGRhdGVTaW5nbGVcclxuICAgICAqIEBhcGlHcm91cCBVc2VyXHJcbiAgICAgKiBAYXBpRGVzY3JpcHRpb24gVXBkYXRlcyBhIHNpbmdsZSB1c2VyLiBDaGFuZ2VzIGV2ZXJ5IHByb3BlcnR5IHRoYXQgaXMgc2V0IGluIHRoZSByZXF1ZXN0IGJvZHkuXHJcbiAgICAgKiBAYXBpUGFyYW0ge1N0cmluZ30gdXNlcm5hbWVcclxuICAgICAqIEBhcGlTdWNjZXNzIHtPYmplY3R9IHVzZXIgVXBkYXRlZCB1c2VyIG9iamVjdFxyXG4gICAgICogQGFwaUVycm9yICg0MDEpIHtTdHJpbmd9IEF1dGhlbnRpZmljYXRpb25FcnJvciBOb3QgYWxsb3dlZCB0byBhY2Nlc3MgcmVzc291cmNlXHJcbiAgICAgKi9cclxuICAgIC5wb3N0KFthdXRoZW50aWNhdGUsIGNoZWNrU2NoZW1hKHVzZXJuYW1lIGFzIGFueSksIHVwZGF0ZVVzZXJdLCAocmVxLCByZXMpID0+IHtcclxuICAgICAgICByZXMuc3RhdHVzKDIwMCkuanNvbih7IHVzZXI6IHJlcy5sb2NhbHMudXNlciB9KVxyXG4gICAgfSlcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gcm91dGVyIl19